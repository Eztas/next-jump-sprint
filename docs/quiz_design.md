# クイズアプリ設計案(Gemini CLI設計)

## 1. 設計方針

Next.jsのApp Routerを活かし、UIをコンポーネント単位で分割して開発を進める。
クイズのロジック（問題の生成や正誤判定など）をUIから分離することで、見通しが良くメンテナンスしやすい構造を目指す。

## 2. ファイル構成

```
src/
└── app/
    ├── page.tsx                # 最初の画面ページ
    ├── layout.tsx              # レイアウト
    └── quiz/
        ├── page.tsx            # クイズ全体の管理・状態を持つページ
        ├── questions.ts        # 問題データ
        ├── quiz-logic.ts       # クイズのロジックをまとめるファイル
        └── _components/        # クイズ専用コンポーネントディレクトリ
            ├── QuizCard.tsx        # 問題表示と選択肢コンポーネント
            ├── Explanation.tsx     # 解説表示コンポーネント
            └── QuizResult.tsx      # 最終結果+解説表示コンポーネント
└── context/
    ├── quizContext.tsx     # その時用いたクイズ情報をコンテキスト化
└── types/
    ├── quiz.ts             # 型定義
```

## 3. 各ファイルの役割

### `quiz-logic.ts` (ロジック担当)

クイズの裏側の処理をすべてまとめる。

-   **役割**:
    -   `questions.ts` から問題データを読み込む。
    -   問題文と正解、そして他の問題の答えをいくつか混ぜて、三択や四択の選択肢 (`selections`) を動的に生成する。
    -   生成した選択肢をシャッフルして、毎回順番が変わるようにする。
    -   ユーザーの回答が正解かどうかを判定する。
-   **実装する関数の例**:
    -   `createQuiz(questionId)`: 特定の問題IDを受け取り、選択肢を生成・シャッフルして `Quiz` 型のオブジェクトを返す関数。
    -   `checkAnswer(userAnswer, correctAnswer)`: ユーザーの回答と正解を比較して `true`/`false` を返す関数。

### `page.tsx` (ページ全体の状態管理)

クイズ全体の進行状況（どの問題か、スコアなど）を管理する親コンポーネント。

-   **役割**:
    -   現在の問題番号、ユーザーのスコア、クイズが終了したかどうかの状態を `useState` で管理する。
    -   `quiz-logic.ts` の関数を呼び出して、表示する問題 (`Quiz` オブジェクト) を生成する。
    -   ユーザーの回答を受け取り、正誤判定を行ってスコアを更新する。
    -   現在の状態に応じて、`QuizCard`、`Explanation`、`QuizResult` のいずれかのコンポーネントを表示する。

### `components/QuizCard.tsx` (問題と選択肢のUI)

ユーザーが直接操作する、問題表示と選択肢のコンポーネント。

-   **役割**:
    -   `page.tsx` から `Quiz` オブジェクトをpropsとして受け取る。
    -   問題文 (`statement`) を表示する。
    -   選択肢 (`selections`) をラジオボタンとして一覧表示する。
    -   ユーザーが選択肢ボタンをクリックしたら、その回答を `page.tsx` に通知する。

### `components/Explanation.tsx` (解説のUI)

ユーザーが回答した後に、正解と解説を表示するコンポーネント。

-   **役割**:
    -   `page.tsx` から問題、ユーザーの回答、正解などの情報を受け取る。
    -   正解・不正解の結果を表示する。
    -   問題のヒント・解説 (`tips`) を表示する。
    -   「次の問題へ」ボタンを表示し、クリックされたら `page.tsx` に通知する。

### `components/QuizResult.tsx` (最終結果のUI)

すべての問題が終わった後に、最終スコアを表示するコンポーネント。

-   **役割**:
    -   `page.tsx` から最終スコアを受け取る。
    -   「5問中4問正解です！」のようなメッセージを表示する。
    -   「もう一度挑戦する」ボタンを表示し、クリックされたら `page.tsx` にクイズをリセットするよう通知する。

## 4. 次のステップ

1.  **`quiz-logic.ts` の作成**: クイズのコアロジックを実装する。
2.  **UIコンポーネントの作成**: `components` ディレクトリ内に各UIコンポーネント (`QuizCard.tsx`, `Explanation.tsx`, `QuizResult.tsx`) を作成する。
3.  **`page.tsx` の実装**: 作成したロジックとUIコンポーネントを組み合わせて、クイズ全体の流れを制御する。
